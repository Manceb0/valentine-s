<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <title>Valentine's</title>
  <link rel="stylesheet" href="style.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>
  <style>
    .code-signature {
      position: fixed;
      bottom: 20px;
      right: 20px;
      font-family: 'Arial', sans-serif;
      color: rgba(255, 105, 180, 0.7);
      font-size: 1em;
      text-shadow: 0 0 10px rgba(255, 105, 180, 0.3);
      letter-spacing: 2px;
      font-weight: bold;
      opacity: 0.8;
      transition: opacity 0.3s ease;
    }

    .code-signature:hover {
      opacity: 1;
      text-shadow: 0 0 15px rgba(255, 105, 180, 0.5);
    }
  </style>
</head>

<body>
  <script>
    (function () {
      var isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.innerWidth < 768;
      var params = new URLSearchParams(window.location.search);
      var forceRegistro = params.has('registro') || params.get('v') === 'registro';
      if (isMobile || forceRegistro) {
        window.location.replace('registro.html');
        return;
      }
    })();
  </script>
  <div class="escenarios-wrapper visible" id="escenarios-wrapper">
    <div class="escenario-controls">
      <button type="button" class="escenario-btn" data-escenario="1">QR</button>
      <button type="button" class="escenario-btn active" data-escenario="2">Visualizaci√≥n 3D</button>
      <button type="button" class="escenario-btn" data-escenario="3">Lista participantes</button>
    </div>
    <div class="escenario-panel" data-escenario="1" id="panel-qr">
      <div class="escenario-qr escenario-qr-doble">
        <h2>Contabilidad seg√∫n la Conciencia</h2>
        <p class="qr-instruction">Escanea cada QR desde tu celular para registrarte</p>
        <div class="qr-doble-row">
          <div class="qr-doble-item">
            <span class="qr-label">Coraz√≥n 1</span>
            <canvas id="qrcode-canvas-a"></canvas>
          </div>
          <div class="qr-doble-item">
            <span class="qr-label">Coraz√≥n 2</span>
            <canvas id="qrcode-canvas-b"></canvas>
          </div>
        </div>
        <p class="codigo-par-display" id="codigo-escenario">C√≥digo de pareja: <strong id="codigo-escenario-val"></strong></p>
      </div>
    </div>
    <div class="escenario-panel active" data-escenario="2" id="panel-3d">
  <div class="start-screen">
    <div class="title-container">
      <div class="title-wrapper">
        <h1 class="main-title">Valentine's</h1>
        <div class="title-overlay"></div>
      </div>
      <h2 class="sub-title">Amorous Symphony</h2>
      <button class="start-button" onclick="launchExperience()">
        <span class="button-text">‚ù§ Start the Magic ‚ù§</span>
        <div class="button-shine"></div>
      </button>
      <div class="floating-hearts">
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
      </div>
    </div>
  </div>

  <div class="players-screen">
    <h2 class="players-title">Contabilidad seg√∫n la Conciencia</h2>
    <p class="players-subtitle">Juego en pareja - Escanea cada QR desde tu celular</p>
    <div class="players-inputs players-qr-row">
      <div class="player-input-group player-left" id="sujeto-a-wrap">
        <label>Coraz√≥n 1</label>
        <div class="qr-wrap" id="qr-a-wrap"><canvas id="qrcode-sujeto-a"></canvas></div>
        <div class="nombre-wrap" id="nombre-a-wrap" style="display: none;">
          <span class="nombre-registrado" id="nombre-a-display"></span>
          <div class="player-badges">
            <span class="genero-registrado" id="genero-a-display"></span>
            <span class="signo-registrado" id="signo-a-display" style="display:none;"></span>
          </div>
          <button type="button" class="btn-resetear-sujeto" id="resetear-a" aria-label="Resetear Coraz√≥n 1">Resetear</button>
        </div>
        <p class="qr-legend" id="legend-a">Escanea para registrarte como Coraz√≥n 1</p>
      </div>
      <div class="player-input-group player-right" id="sujeto-b-wrap">
        <label>Coraz√≥n 2</label>
        <div class="qr-wrap" id="qr-b-wrap"><canvas id="qrcode-sujeto-b"></canvas></div>
        <div class="nombre-wrap" id="nombre-b-wrap" style="display: none;">
          <span class="nombre-registrado" id="nombre-b-display"></span>
          <div class="player-badges">
            <span class="genero-registrado" id="genero-b-display"></span>
            <span class="signo-registrado" id="signo-b-display" style="display:none;"></span>
          </div>
          <button type="button" class="btn-resetear-sujeto" id="resetear-b" aria-label="Resetear Coraz√≥n 2">Resetear</button>
        </div>
        <p class="qr-legend" id="legend-b">Escanea para registrarte como Coraz√≥n 2</p>
      </div>
    </div>
    <!-- Estado del quiz y resultado de compatibilidad -->
    <div class="match-area" id="match-area" style="display:none;">
      <!-- En proceso -->
      <div class="match-in-progress" id="match-in-progress">
        <span class="match-pulse-icon">üíï</span>
        <span class="match-status-text">Completando quiz...</span>
      </div>
      <!-- Resultado -->
      <div class="match-result" id="match-result" style="display:none;">
        <div class="match-circle-wrap">
          <svg class="match-circle-svg" viewBox="0 0 120 120">
            <circle class="match-circle-bg" cx="60" cy="60" r="54" />
            <circle class="match-circle-fill" id="match-circle-fill" cx="60" cy="60" r="54" />
          </svg>
          <div class="match-pct-inner">
            <span class="match-pct-num" id="match-pct-num">0</span><span class="match-pct-sign">%</span>
          </div>
        </div>
        <h3 class="match-label" id="match-label"></h3>
        <p class="match-text" id="match-text"></p>
      </div>
    </div>

    <p class="players-codigo" id="codigo-par-display">C√≥digo de pareja: <strong id="codigo-par-val"></strong></p>
    <div class="players-bottom-buttons">
      <button type="button" class="btn-volver-qr" id="btn-volver-qr" style="display: none;">Ver c√≥digos QR</button>
      <button type="button" class="btn-nueva-pareja" id="btn-nueva-pareja" style="display: none;">Nueva pareja ‚Ü©</button>
    </div>
  </div>

  <div class="scene">
    <div class="valentine-text">
      <div class="main-text">Happy Valentine's Day</div>
    </div>
  </div>
  <div class="loading-screen">Initializing Cosmic Love...</div>
    </div>
    <div class="escenario-panel" data-escenario="3" id="panel-lista">
      <div class="escenario-lista">
        <h2>Participantes</h2>
        <ul class="lista-participantes" id="lista-participantes"></ul>
      </div>
    </div>
  </div>
  <script type="module" src="script.js"></script>
</body>

</html>
