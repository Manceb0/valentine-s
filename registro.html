<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Registro - Valentine's</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
</head>
<body class="registro-page">
  <div id="registro-form-container" class="registro-container quiz-container">
    <!-- Progress bar -->
    <div class="quiz-progress-wrap">
      <div class="quiz-progress"><div class="quiz-progress-bar" id="quiz-progress-bar"></div></div>
      <span class="quiz-step-counter" id="quiz-step-counter"></span>
    </div>

    <!-- PRE: Elegir flujo (solo si no viene por QR) -->
    <div class="quiz-step" data-step="pre">
      <h2 class="quiz-question">Â¿CÃ³mo quieren jugar? ğŸ’•</h2>
      <p class="quiz-sub">Elige una opciÃ³n para empezar</p>
      <div class="pre-flow-options">
        <button type="button" class="pre-flow-card" id="btn-crear-pareja">
          <span class="pre-flow-icon">ğŸ’</span>
          <span class="pre-flow-title">Crear pareja</span>
          <span class="pre-flow-desc">Genera un cÃ³digo y compÃ¡rtelo</span>
        </button>
        <button type="button" class="pre-flow-card" id="btn-unirse-pareja">
          <span class="pre-flow-icon">ğŸ”—</span>
          <span class="pre-flow-title">Tengo un cÃ³digo</span>
          <span class="pre-flow-desc">Mi pareja ya creÃ³ uno</span>
        </button>
      </div>
    </div>

    <!-- PRE-CODE: CÃ³digo generado para compartir -->
    <div class="quiz-step" data-step="pre-code">
      <h2 class="quiz-question">Â¡Tu cÃ³digo de pareja! ğŸ’Œ</h2>
      <p class="quiz-sub">Comparte este cÃ³digo con tu pareja para que se una</p>
      <div class="generated-code-wrap">
        <div class="generated-code" id="generated-code"></div>
        <button type="button" class="btn-copy-code" id="btn-copy-code" title="Copiar cÃ³digo">ğŸ“‹</button>
      </div>
      <p class="quiz-sub generated-code-hint">Dile a tu pareja que abra este link y elija "Tengo un cÃ³digo"</p>
      <button type="button" class="quiz-next-btn" id="btn-code-ready">Mi pareja ya lo tiene â†’</button>
    </div>

    <!-- PRE-CONFIRM: Comprobar que la pareja se uniÃ³ (solo quien creÃ³ el cÃ³digo) -->
    <div class="quiz-step" data-step="pre-confirm">
      <h2 class="quiz-question">Â¿Tu pareja ya se uniÃ³? ğŸ’•</h2>
      <div class="pre-confirm-status" id="pre-confirm-status">
        <div class="pre-confirm-spinner" id="pre-confirm-spinner"></div>
        <p class="pre-confirm-msg" id="pre-confirm-msg">Comprobando...</p>
      </div>
      <div class="pre-confirm-actions" id="pre-confirm-actions" style="display:none;">
        <button type="button" class="quiz-next-btn" id="btn-confirm-start">Empezar el quiz â†’</button>
      </div>
      <div class="pre-confirm-retry" id="pre-confirm-retry" style="display:none;">
        <p class="quiz-sub">Pide a tu pareja que ingrese el cÃ³digo e intÃ©ntalo de nuevo.</p>
        <button type="button" class="quiz-next-btn" id="btn-confirm-retry">Reintentar</button>
        <button type="button" class="quiz-next-btn quiz-next-btn-ghost" id="btn-confirm-skip">Empezar sin confirmar</button>
      </div>
    </div>

    <!-- PRE-JOIN: Ingresar cÃ³digo -->
    <div class="quiz-step" data-step="pre-join">
      <h2 class="quiz-question">CÃ³digo de pareja ğŸ”—</h2>
      <p class="quiz-sub">Ingresa el cÃ³digo que te compartiÃ³ tu pareja</p>
      <input type="text" id="codigo_manual" class="quiz-input" placeholder="Ej: A7F3K2" maxlength="6" autocomplete="off" style="text-transform:uppercase; text-align:center; font-size:1.5em; letter-spacing:4px;">
      <button type="button" class="quiz-next-btn" id="btn-join-submit">Unirme â†’</button>
      <p id="registro-error-pre" class="registro-error" style="display:none;"></p>
    </div>

    <!-- 0: Nombre -->
    <div class="quiz-step" data-step="0">
      <h2 class="quiz-question">Â¿CÃ³mo te llamas? ğŸ’«</h2>
      <input type="text" id="nombre" class="quiz-input" placeholder="Tu nombre" maxlength="100" autocomplete="off">
      <button type="button" class="quiz-next-btn" id="btn-nombre-next">Siguiente â†’</button>
    </div>

    <!-- 1: GÃ©nero -->
    <div class="quiz-step" data-step="1">
      <h2 class="quiz-question">Â¿Con quÃ© gÃ©nero te identificas?</h2>
      <div class="chip-group" data-field="genero" data-max="1" data-auto="true">
        <button type="button" class="chip" data-value="Masculino">ğŸ‘¨ Masculino</button>
        <button type="button" class="chip" data-value="Femenino">ğŸ‘© Femenino</button>
        <button type="button" class="chip" data-value="Otro">ğŸŒˆ Otro</button>
        <button type="button" class="chip" data-value="Prefiero no decir">ğŸ¤« Prefiero no decir</button>
      </div>
    </div>

    <!-- 2: Fecha de nacimiento -->
    <div class="quiz-step" data-step="2">
      <h2 class="quiz-question">Â¿CuÃ¡ndo naciste? ğŸ‚</h2>
      <input type="date" id="fecha_nacimiento" class="quiz-input quiz-input-date">
      <div class="zodiac-reveal" id="zodiac-reveal" style="display:none;">
        <span class="zodiac-reveal-symbol" id="zodiac-symbol"></span>
        <span class="zodiac-reveal-name" id="zodiac-name"></span>
      </div>
      <button type="button" class="quiz-next-btn" id="btn-birthday-next">Siguiente â†’</button>
    </div>

    <!-- 3: Carrera -->
    <div class="quiz-step" data-step="3">
      <h2 class="quiz-question">Â¿QuÃ© estudias o te gustarÃ­a estudiar? ğŸ“š</h2>
      <p class="quiz-sub">Elige una</p>
      <div class="chip-group" data-field="carrera" data-max="1" data-auto="true">
        <button type="button" class="chip" data-value="IngenierÃ­a">IngenierÃ­a</button>
        <button type="button" class="chip" data-value="Medicina">Medicina</button>
        <button type="button" class="chip" data-value="Derecho">Derecho</button>
        <button type="button" class="chip" data-value="Artes / DiseÃ±o">Artes / DiseÃ±o</button>
        <button type="button" class="chip" data-value="AdministraciÃ³n">AdministraciÃ³n</button>
        <button type="button" class="chip" data-value="Ciencias">Ciencias</button>
        <button type="button" class="chip" data-value="Humanidades">Humanidades</button>
        <button type="button" class="chip" data-value="EducaciÃ³n">EducaciÃ³n</button>
        <button type="button" class="chip" data-value="Otra">Otra</button>
      </div>
    </div>

    <!-- â•â•â• PREGUNTAS LIGERAS (4-7) â•â•â• -->
    <div class="quiz-step" data-step="4">
      <h2 class="quiz-question">Â¿QuÃ© prefieres?</h2>
      <div class="prefer-options" data-field="prefer_dinero_amor">
        <button type="button" class="prefer-card" data-value="Dinero">ğŸ’°<span>Dinero</span></button>
        <span class="prefer-vs">VS</span>
        <button type="button" class="prefer-card" data-value="Amor">â¤ï¸<span>Amor</span></button>
      </div>
    </div>
    <div class="quiz-step" data-step="5">
      <h2 class="quiz-question">Â¿QuÃ© prefieres?</h2>
      <div class="prefer-options" data-field="prefer_playa_montana">
        <button type="button" class="prefer-card" data-value="Playa">ğŸ–ï¸<span>Playa</span></button>
        <span class="prefer-vs">VS</span>
        <button type="button" class="prefer-card" data-value="MontaÃ±a">ğŸ”ï¸<span>MontaÃ±a</span></button>
      </div>
    </div>
    <div class="quiz-step" data-step="6">
      <h2 class="quiz-question">Â¿QuÃ© prefieres?</h2>
      <div class="prefer-options" data-field="prefer_noche_dia">
        <button type="button" class="prefer-card" data-value="Noche">ğŸŒ™<span>Noche</span></button>
        <span class="prefer-vs">VS</span>
        <button type="button" class="prefer-card" data-value="DÃ­a">â˜€ï¸<span>DÃ­a</span></button>
      </div>
    </div>
    <div class="quiz-step" data-step="7">
      <h2 class="quiz-question">Â¿QuÃ© prefieres?</h2>
      <div class="prefer-options" data-field="prefer_netflix_fiesta">
        <button type="button" class="prefer-card" data-value="Netflix en casa">ğŸ¬<span>Netflix en casa</span></button>
        <span class="prefer-vs">VS</span>
        <button type="button" class="prefer-card" data-value="Salir de fiesta">ğŸ‰<span>Salir de fiesta</span></button>
      </div>
    </div>

    <!-- â•â•â• PREGUNTAS PROFUNDAS (7-14) â•â•â• -->
    <div class="quiz-step" data-step="8">
      <h2 class="quiz-question">En una relaciÃ³n...</h2>
      <div class="prefer-options" data-field="prefer_perdonar_justicia">
        <button type="button" class="prefer-card" data-value="Perdonar">ğŸ•Šï¸<span>Perdonar fÃ¡cil</span></button>
        <span class="prefer-vs">VS</span>
        <button type="button" class="prefer-card" data-value="Consecuencias">âš–ï¸<span>Que asuma consecuencias</span></button>
      </div>
    </div>
    <div class="quiz-step" data-step="9">
      <h2 class="quiz-question">Cuando hay un problema...</h2>
      <div class="prefer-options" data-field="prefer_hablar_espacio">
        <button type="button" class="prefer-card" data-value="Hablarlo ya">ğŸ—£ï¸<span>Hablarlo de una vez</span></button>
        <span class="prefer-vs">VS</span>
        <button type="button" class="prefer-card" data-value="Dar espacio">ğŸ§˜<span>Dar espacio primero</span></button>
      </div>
    </div>
    <div class="quiz-step" data-step="10">
      <h2 class="quiz-question">Â¿QuÃ© te guÃ­a mÃ¡s?</h2>
      <div class="prefer-options" data-field="prefer_razon_corazon">
        <button type="button" class="prefer-card" data-value="La razÃ³n">ğŸ§ <span>La razÃ³n</span></button>
        <span class="prefer-vs">VS</span>
        <button type="button" class="prefer-card" data-value="El corazÃ³n">ğŸ’—<span>El corazÃ³n</span></button>
      </div>
    </div>
    <div class="quiz-step" data-step="11">
      <h2 class="quiz-question">En la vida prefieres...</h2>
      <div class="prefer-options" data-field="prefer_planificar_improvisar">
        <button type="button" class="prefer-card" data-value="Planificar">ğŸ“‹<span>Tener todo planeado</span></button>
        <span class="prefer-vs">VS</span>
        <button type="button" class="prefer-card" data-value="Improvisar">ğŸŒŠ<span>Fluir e improvisar</span></button>
      </div>
    </div>
    <div class="quiz-step" data-step="12">
      <h2 class="quiz-question">Prefieres tener...</h2>
      <div class="prefer-options" data-field="prefer_pocas_muchas">
        <button type="button" class="prefer-card" data-value="Pocas profundas">ğŸ’<span>Pocas amistades pero profundas</span></button>
        <span class="prefer-vs">VS</span>
        <button type="button" class="prefer-card" data-value="Muchas amistades">ğŸ­<span>Muchos amigos y conocidos</span></button>
      </div>
    </div>
    <div class="quiz-step" data-step="13">
      <h2 class="quiz-question">Â¿QuÃ© es mÃ¡s importante?</h2>
      <div class="prefer-options" data-field="prefer_feliz_razon">
        <button type="button" class="prefer-card" data-value="Ser feliz">ğŸ˜Š<span>Ser feliz</span></button>
        <span class="prefer-vs">VS</span>
        <button type="button" class="prefer-card" data-value="Tener razÃ³n">ğŸ†<span>Tener la razÃ³n</span></button>
      </div>
    </div>
    <div class="quiz-step" data-step="14">
      <h2 class="quiz-question">Â¿CÃ³mo vives?</h2>
      <div class="prefer-options" data-field="prefer_presente_futuro">
        <button type="button" class="prefer-card" data-value="Vivir el momento">ğŸŒ…<span>Vivir el momento</span></button>
        <span class="prefer-vs">VS</span>
        <button type="button" class="prefer-card" data-value="Construir futuro">ğŸ—ï¸<span>Construir el futuro</span></button>
      </div>
    </div>
    <div class="quiz-step" data-step="15">
      <h2 class="quiz-question">En el amor prefieres...</h2>
      <div class="prefer-options" data-field="prefer_dar_recibir">
        <button type="button" class="prefer-card" data-value="Dar cariÃ±o">ğŸ«‚<span>Dar cariÃ±o</span></button>
        <span class="prefer-vs">VS</span>
        <button type="button" class="prefer-card" data-value="Recibir cariÃ±o">ğŸ¥°<span>Recibir cariÃ±o</span></button>
      </div>
    </div>

    <!-- â•â•â• SELECCIONES (15-19) â•â•â• -->
    <div class="quiz-step" data-step="16">
      <h2 class="quiz-question">Tu color favorito ğŸ¨</h2>
      <div class="chip-group" data-field="color_favorito" data-max="1" data-auto="true">
        <button type="button" class="chip chip-color" data-value="Rojo"><span class="chip-dot" style="background:#e74c3c"></span>Rojo</button>
        <button type="button" class="chip chip-color" data-value="Azul"><span class="chip-dot" style="background:#3498db"></span>Azul</button>
        <button type="button" class="chip chip-color" data-value="Rosa"><span class="chip-dot" style="background:#ff69b4"></span>Rosa</button>
        <button type="button" class="chip chip-color" data-value="Morado"><span class="chip-dot" style="background:#9b59b6"></span>Morado</button>
        <button type="button" class="chip chip-color" data-value="Verde"><span class="chip-dot" style="background:#2ecc71"></span>Verde</button>
        <button type="button" class="chip chip-color" data-value="Negro"><span class="chip-dot" style="background:#2c3e50"></span>Negro</button>
        <button type="button" class="chip chip-color" data-value="Amarillo"><span class="chip-dot" style="background:#f1c40f"></span>Amarillo</button>
        <button type="button" class="chip chip-color" data-value="Naranja"><span class="chip-dot" style="background:#e67e22"></span>Naranja</button>
      </div>
    </div>

    <div class="quiz-step" data-step="17">
      <h2 class="quiz-question">Â¿QuÃ© valoras mÃ¡s en una relaciÃ³n? ğŸ’</h2>
      <p class="quiz-sub">Elige hasta 3</p>
      <div class="chip-group" data-field="valores_relacion" data-max="3">
        <button type="button" class="chip" data-value="Confianza">ğŸ”’ Confianza</button>
        <button type="button" class="chip" data-value="ComunicaciÃ³n">ğŸ’¬ ComunicaciÃ³n</button>
        <button type="button" class="chip" data-value="Humor">ğŸ˜‚ Humor</button>
        <button type="button" class="chip" data-value="PasiÃ³n">ğŸ”¥ PasiÃ³n</button>
        <button type="button" class="chip" data-value="Respeto">ğŸ¤ Respeto</button>
        <button type="button" class="chip" data-value="Libertad">ğŸ¦… Libertad</button>
        <button type="button" class="chip" data-value="Lealtad">ğŸ›¡ï¸ Lealtad</button>
        <button type="button" class="chip" data-value="Apoyo">ğŸ’ª Apoyo</button>
        <button type="button" class="chip" data-value="Aventura">ğŸŒ Aventura</button>
        <button type="button" class="chip" data-value="Estabilidad">ğŸ  Estabilidad</button>
      </div>
      <button type="button" class="quiz-next-btn quiz-next-chips">Siguiente â†’</button>
    </div>

    <div class="quiz-step" data-step="18">
      <h2 class="quiz-question">MÃºsica favorita ğŸµ</h2>
      <p class="quiz-sub">Elige hasta 3</p>
      <div class="chip-group" data-field="musica_favorita" data-max="3">
        <button type="button" class="chip" data-value="ReggaetÃ³n">ReggaetÃ³n</button>
        <button type="button" class="chip" data-value="Pop">Pop</button>
        <button type="button" class="chip" data-value="Rock">Rock</button>
        <button type="button" class="chip" data-value="Bachata">Bachata</button>
        <button type="button" class="chip" data-value="Salsa">Salsa</button>
        <button type="button" class="chip" data-value="ElectrÃ³nica">ElectrÃ³nica</button>
        <button type="button" class="chip" data-value="R&B / Hip Hop">R&B / Hip Hop</button>
        <button type="button" class="chip" data-value="Indie">Indie</button>
        <button type="button" class="chip" data-value="Vallenato">Vallenato</button>
        <button type="button" class="chip" data-value="De todo">De todo</button>
      </div>
      <button type="button" class="quiz-next-btn quiz-next-chips">Siguiente â†’</button>
    </div>

    <div class="quiz-step" data-step="19">
      <h2 class="quiz-question">Â¿QuÃ© te hace feliz? ğŸ˜Š</h2>
      <p class="quiz-sub">Elige hasta 3</p>
      <div class="chip-group" data-field="algo_feliz" data-max="3">
        <button type="button" class="chip" data-value="Mi familia">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Mi familia</button>
        <button type="button" class="chip" data-value="Mis amigos">ğŸ‘¯ Mis amigos</button>
        <button type="button" class="chip" data-value="La mÃºsica">ğŸ¶ La mÃºsica</button>
        <button type="button" class="chip" data-value="Viajar">ğŸŒ Viajar</button>
        <button type="button" class="chip" data-value="Comer rico">ğŸ• Comer rico</button>
        <button type="button" class="chip" data-value="Los animales">ğŸ¶ Los animales</button>
        <button type="button" class="chip" data-value="El amor">â¤ï¸ El amor</button>
        <button type="button" class="chip" data-value="Estar tranquilo">ğŸ§˜ Tranquilidad</button>
        <button type="button" class="chip" data-value="Aprender cosas nuevas">ğŸ’¡ Aprender</button>
        <button type="button" class="chip" data-value="Los atardeceres">ğŸŒ… Atardeceres</button>
      </div>
      <button type="button" class="quiz-next-btn quiz-next-chips">Finalizar âœ¨</button>
    </div>

    <p id="registro-error" class="registro-error" style="display:none;"></p>
  </div>

  <!-- Pantalla de espera -->
  <div id="quiz-waiting" class="quiz-waiting-screen" style="display:none;">
    <div class="waiting-content">
      <div class="waiting-hearts">ğŸ’•</div>
      <h2>Â¡Listo!</h2>
      <p>Esperando a que tu pareja termine...</p>
      <div class="waiting-loader"><span></span><span></span><span></span></div>
    </div>
  </div>

  <!-- Pantalla de resultado -->
  <div id="quiz-result" class="quiz-result-screen" style="display:none;">
    <div class="result-content">
      <h2 class="result-title">Compatibilidad</h2>
      <div class="result-circle-wrap">
        <svg class="result-circle" viewBox="0 0 120 120">
          <circle class="result-circle-bg" cx="60" cy="60" r="54" />
          <circle class="result-circle-fill" id="result-circle-fill" cx="60" cy="60" r="54" />
        </svg>
        <div class="result-percentage-inner">
          <span class="result-percentage" id="result-percentage">0</span><span class="result-percent-sign">%</span>
        </div>
      </div>
      <h3 class="result-label" id="result-label"></h3>
      <p class="result-justification" id="result-justification"></p>
      <div class="result-matches" id="result-matches"></div>
      <button type="button" class="quiz-next-btn result-restart-btn" id="btn-restart" onclick="window.location.reload()">Volver al inicio â†©</button>
    </div>
  </div>

  <script type="module" src="registro.js"></script>
</body>
</html>
